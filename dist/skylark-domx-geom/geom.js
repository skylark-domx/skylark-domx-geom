/**
 * skylark-domx-geom - The skylark geom library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-styler"],function(t,e,i,o){var n,f=/^(?:body|html)$/i,l=e.toPixel,h=i.offsetParent;function r(){if(void 0!==n)return n;var t,e,f=i.createFragment("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")[0],l=f.childNodes[0];return i.append(document.body,f),t=l.offsetWidth,o.css(f,"overflow","scroll"),t===(e=l.offsetWidth)&&(e=f[0].clientWidth),i.remove(f),n=t-e}function s(t){if(i.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:l(e.borderLeftWidth,t),top:l(e.borderTopWidth,t),right:l(e.borderRightWidth,t),bottom:l(e.borderBottomWidth,t)}}function d(t,e){if(void 0===e)return f.test(t.nodeName)?{top:0,left:0}:t.getBoundingClientRect();var i=h(t),o=d(i),n=c(t),l=s(i);return v(t,{top:e.top-o.top-n.top-l.top,left:e.left-o.left-n.left-l.left}),this}function g(t,e){return void 0===e?t.getBoundingClientRect():(d(t,e),x(t,e),this)}function p(t,e){if(void 0==e)return{width:t.clientWidth,height:t.clientHeight};var i="border-box"===o.css(t,"box-sizing"),n={width:e.width,height:e.height};if(i){var f=s(t);void 0!==n.width&&(n.width=n.width+f.left+f.right),void 0!==n.height&&(n.height=n.height+f.top+f.bottom)}else{var l=u(t);void 0!==n.width&&(n.width=n.width-l.left-l.right),void 0!==n.height&&(n.height=n.height-l.top-l.bottom)}return o.css(t,n),this}function a(t){var e=t.documentElement,i=t.body,o=Math.max,n=o(e.scrollWidth,i.scrollWidth),f=o(e.clientWidth,i.clientWidth),l=o(e.offsetWidth,i.offsetWidth),h=o(e.scrollHeight,i.scrollHeight),r=o(e.clientHeight,i.clientHeight),s=o(e.offsetHeight,i.offsetHeight);return{width:n<l?f:n,height:h<s?r:h}}function c(t){if(i.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:l(e.marginLeft),top:l(e.marginTop),right:l(e.marginRight),bottom:l(e.marginBottom)}}function w(t){var e=x(t),i=c(t);return{width:e.width+i.left+i.right,height:e.height+i.top+i.bottom}}function u(t){if(i.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:l(e.paddingLeft),top:l(e.paddingTop),right:l(e.paddingRight),bottom:l(e.paddingBottom)}}function m(t,e){if(void 0===e){var i=t.getBoundingClientRect();return{left:i.left+window.pageXOffset,top:i.top+window.pageYOffset}}var o=h(t),n=m(o),f=c(t),l=s(o);return v(t,{top:e.top-n.top-f.top-l.top,left:e.left-n.left-f.left-l.left}),this}function v(t,e){if(void 0==e){var i=h(t),n=d(t),f=d(i),l=(c(t),s(i));return{top:n.top-f.top-l.top,left:n.left-f.left-l.left}}var r={top:e.top,left:e.left};return"static"==o.css(t,"position")&&(r.position="relative"),o.css(t,r),this}function W(t,e){if(void 0===e){var i=h(t),o=g(t),n=d(i),f=(c(t),s(i));return{top:o.top-n.top-f.top,left:o.left-n.left-f.left,width:o.width,height:o.height}}return v(t,e),x(t,e),this}function y(t,e){9===t.nodeType&&(t=t.defaultView);var i="scrollLeft"in t;return void 0===e?i?t.scrollLeft:t.pageXOffset:(i?t.scrollLeft=e:t.scrollTo(e,t.scrollY),this)}function b(t,e){9===t.nodeType&&(t=t.defaultView);var i="scrollTop"in t;return void 0===e?i?t.scrollTop:t.pageYOffset:(i?t.scrollTop=e:t.scrollTo(t.scrollX,e),this)}function x(t,i){if(void 0==i)return e.isWindow(t)?{width:t.innerWidth,height:t.innerHeight}:e.isDocument(t)?a(document):{width:t.offsetWidth,height:t.offsetHeight};var n="border-box"===o.css(t,"box-sizing"),f={width:i.width,height:i.height};if(!n){var l=u(t),h=s(t);void 0!==f.width&&""!==f.width&&null!==f.width&&(f.width=f.width-l.left-l.right-h.left-h.right),void 0!==f.height&&""!==f.height&&null!==f.height&&(f.height=f.height-l.top-l.bottom-h.top-h.bottom)}return o.css(t,f),this}function H(){return H}return e.mixin(H,{borderExtents:s,boundingPosition:d,boundingRect:g,clientHeight:function(t,e){return void 0==e?p(t).height:p(t,{height:e})},clientSize:p,clientWidth:function(t,e){return void 0==e?p(t).width:(p(t,{width:e}),this)},contentRect:function(t){var e=p(t),i=u(t);return{left:i.left,top:i.top,width:e.width-i.left-i.right,height:e.height-i.top-i.bottom}},fullCover:function(t,i,o){let n=o,f=i;e.isUndefined(f)&&(f=!0),e.isUndefined(n)&&(n=!0),t.style.position="absolute",f&&(t.style.left=0,t.style.right=0),n&&(t.style.top=0,t.style.bottom=0)},getDocumentSize:a,height:function(t,e){return void 0==e?x(t).height:(x(t,{height:e}),this)},isVisible:function(t){for(var e=t.offsetTop,i=t.offsetLeft,o=t.offsetWidth,n=t.offsetHeight;t.offsetParent;)e+=(t=t.offsetParent).offsetTop,i+=t.offsetLeft;return value=e>=window.pageYOffset&&i>=window.pageXOffset&&e+n<=window.pageYOffset+window.innerHeight&&i+o<=window.pageXOffset+window.innerWidth},marginExtents:c,marginRect:function(t){var e=W(t),i=c(t);return{left:e.left,top:e.top,width:e.width+i.left+i.right,height:e.height+i.top+i.bottom}},marginSize:w,offsetParent:h,paddingExtents:u,pagePosition:m,pageRect:function(t,e){if(void 0===e){var i=t.getBoundingClientRect();return{left:i.left+window.pageXOffset,top:i.top+window.pageYOffset,width:Math.round(i.width),height:Math.round(i.height)}}return m(t,e),x(t,e),this},relativePosition:v,relativeRect:W,scrollbarWidth:r,scrollIntoView:function(t,e){var i,o,n,f,l,h,r=t.parentNode,s=function(t,e){var i,o,n=t;for(i=o=0;n&&n!=e&&n.nodeType;)i+=n.offsetLeft||0,o+=n.offsetTop||0,n=n.offsetParent;return{x:i,y:o}}(t,r);return i=s.x,o=s.y,n=t.offsetWidth,f=t.offsetHeight,l=r.clientWidth,h=r.clientHeight,"end"==e?(i-=l-n,o-=h-f):"center"==e&&(i-=l/2-n/2,o-=h/2-f/2),r.scrollLeft=i,r.scrollTop=o,this},scrollLeft:y,scrollTop:b,size:x,testAxis:function(t){for(var e=t.offsetTop,i=t.offsetLeft,o=t.offsetWidth,n=t.offsetHeight;t.offsetParent;)e+=(t=t.offsetParent).offsetTop,i+=t.offsetLeft;var f={x:0,y:0};return e<window.pageYOffset?f.y=e-window.pageYOffset:e+n>window.pageYOffset+window.innerHeight&&(f.y=e+n-(window.pageYOffset+window.innerHeight)),i<window.pageXOffset?f.x=i-window.pageXOffset:i+o>window.pageXOffset+window.innerWidth&&(f.x=i+o-(window.pageXOffset+window.innerWidth)),f},width:function(t,e){return void 0==e?x(t).width:(x(t,{width:e}),this)}}),function(){var t=Math.max,n=Math.abs,f=/left|center|right/,l=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,d=/%$/;function g(t,e,i){return[parseFloat(t[0])*(d.test(t[0])?e/100:1),parseFloat(t[1])*(d.test(t[1])?i/100:1)]}function p(t,e){return parseInt(o.css(t,e),10)||0}var a={fit:{left:function(e,i){var o,n=i.within,f=n.isWindow?n.scrollLeft:n.offset.left,l=n.width,h=e.left-i.collisionPosition.marginLeft,r=f-h,s=h+i.collisionWidth-l-f;i.collisionWidth>l?r>0&&s<=0?(o=e.left+r+i.collisionWidth-l-f,e.left+=r-o):e.left=s>0&&r<=0?f:r>s?f+l-i.collisionWidth:f:r>0?e.left+=r:s>0?e.left-=s:e.left=t(e.left-h,e.left)},top:function(e,i){var o,n=i.within,f=n.isWindow?n.scrollTop:n.offset.top,l=i.within.height,h=e.top-i.collisionPosition.marginTop,r=f-h,s=h+i.collisionHeight-l-f;i.collisionHeight>l?r>0&&s<=0?(o=e.top+r+i.collisionHeight-l-f,e.top+=r-o):e.top=s>0&&r<=0?f:r>s?f+l-i.collisionHeight:f:r>0?e.top+=r:s>0?e.top-=s:e.top=t(e.top-h,e.top)}},flip:{left:function(t,e){var i,o,f=e.within,l=f.offset.left+f.scrollLeft,h=f.width,r=f.isWindow?f.scrollLeft:f.offset.left,s=t.left-e.collisionPosition.marginLeft,d=s-r,g=s+e.collisionWidth-h-r,p="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,a="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,c=-2*e.offset[0];d<0?((i=t.left+p+a+c+e.collisionWidth-h-l)<0||i<n(d))&&(t.left+=p+a+c):g>0&&((o=t.left-e.collisionPosition.marginLeft+p+a+c-r)>0||n(o)<g)&&(t.left+=p+a+c)},top:function(t,e){var i,o,f=e.within,l=f.offset.top+f.scrollTop,h=f.height,r=f.isWindow?f.scrollTop:f.offset.top,s=t.top-e.collisionPosition.marginTop,d=s-r,g=s+e.collisionHeight-h-r,p="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,a="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,c=-2*e.offset[1];d<0?((o=t.top+p+a+c+e.collisionHeight-h-l)<0||o<n(d))&&(t.top+=p+a+c):g>0&&((i=t.top-e.collisionPosition.marginTop+p+a+c-r)>0||n(i)<g)&&(t.top+=p+a+c)}},flipfit:{left:function(){a.flip.left.apply(this,arguments),a.fit.left.apply(this,arguments)},top:function(){a.flip.top.apply(this,arguments),a.fit.top.apply(this,arguments)}}};H.posit=function(d,c){var u,v,W,H,T,L,O,P,z,R,k,X,Y,B=(c=e.extend({},c)).of,C=(O=c.within,P=O||window,z=i.isWindow(P),R=!!P&&9===P.nodeType,k=!z&&!R,X=w(P),{element:P,isWindow:z,isDocument:R,offset:k?m(O):{left:0,top:0},scrollLeft:y(P),scrollTop:b(P),width:X.width,height:X.height}),D=function(t){var e=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-x"),i=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-y"),n="scroll"===e||"auto"===e&&t.width<scrollWidth(t.element);return{width:"scroll"===i||"auto"===i&&t.height<scrollHeight(t.element)?r():0,height:n?r():0}}(C),S=(c.collision||"flip").split(" "),M={};return L=9===(Y=B).nodeType?{size:x(Y),offset:{top:0,left:0}}:i.isWindow(Y)?{size:x(Y),offset:{top:b(Y),left:y(Y)}}:Y.preventDefault?{size:{width:0,height:0},offset:{top:Y.pageY,left:Y.pageX}}:{size:x(Y),offset:m(Y)},B.preventDefault&&(c.at="left top"),v=L.size.width,W=L.size.height,H=L.offset,T=e.extend({},H),e.each(["my","at"],function(){var t,e,i=(c[this]||"").split(" ");1===i.length&&(i=f.test(i[0])?i.concat(["center"]):l.test(i[0])?["center"].concat(i):["center","center"]),i[0]=f.test(i[0])?i[0]:"center",i[1]=l.test(i[1])?i[1]:"center",t=h.exec(i[0]),e=h.exec(i[1]),M[this]=[t?t[0]:0,e?e[0]:0],c[this]=[s.exec(i[0])[0],s.exec(i[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===c.at[0]?T.left+=v:"center"===c.at[0]&&(T.left+=v/2),"bottom"===c.at[1]?T.top+=W:"center"===c.at[1]&&(T.top+=W/2),u=g(M.at,v,W),T.left+=u[0],T.top+=u[1],function(i){var o,f,l=w(i),h=l.width,r=l.height,s=p(i,"marginLeft"),d=p(i,"marginTop"),y=h+s+p(i,"marginRight")+D.width,b=r+d+p(i,"marginBottom")+D.height,x=e.extend({},T),L=g(M.my,l.width,l.height);"right"===c.my[0]?x.left-=h:"center"===c.my[0]&&(x.left-=h/2),"bottom"===c.my[1]?x.top-=r:"center"===c.my[1]&&(x.top-=r/2),x.left+=L[0],x.top+=L[1],o={marginLeft:s,marginTop:d},e.each(["left","top"],function(t,e){a[S[t]]&&a[S[t]][e](x,{targetWidth:v,targetHeight:W,elemWidth:h,elemHeight:r,collisionPosition:o,collisionWidth:y,collisionHeight:b,offset:[u[0]+L[0],u[1]+L[1]],my:c.my,at:c.at,within:C,elem:i})}),c.using&&(f=function(e){var o=H.left-x.left,f=o+v-h,l=H.top-x.top,s=l+W-r,d={target:{element:B,left:H.left,top:H.top,width:v,height:W},element:{element:i,left:x.left,top:x.top,width:h,height:r},horizontal:f<0?"left":o>0?"right":"center",vertical:s<0?"top":l>0?"bottom":"middle"};v<h&&n(o+f)<v&&(d.horizontal="center"),W<r&&n(l+s)<W&&(d.vertical="middle"),t(n(o),n(f))>t(n(l),n(s))?d.important="horizontal":d.important="vertical",c.using.call(this,e,d)}),m(i,e.extend(x,{using:f}))}(d)}}(),t.attach("domx.geom",H)});
//# sourceMappingURL=sourcemaps/geom.js.map
