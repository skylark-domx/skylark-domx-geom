/**
 * skylark-domx-geom - The skylark geom library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-styler"],function(t,e,i,o){var n,l=/^(?:body|html)$/i,f=e.toPixel,r=i.offsetParent;function h(){if(void 0!==n)return n;var t,e,l=i.createFragment("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")[0],f=l.childNodes[0];return i.append(document.body,l),t=f.offsetWidth,o.css(l,"overflow","scroll"),t===(e=f.offsetWidth)&&(e=l[0].clientWidth),i.remove(l),n=t-e}function d(t){if(i.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:f(e.borderLeftWidth,t),top:f(e.borderTopWidth,t),right:f(e.borderRightWidth,t),bottom:f(e.borderBottomWidth,t)}}function s(t,e){if(void 0===e)return l.test(t.nodeName)?{top:0,left:0}:t.getBoundingClientRect();var i=r(t),o=s(i),n=a(t),f=d(i);return v(t,{top:e.top-o.top-n.top-f.top,left:e.left-o.left-n.left-f.left}),this}function c(t,e){return void 0!==e?(s(t,e),x(t,e),this):t==window||t==document.documentElement||t==document.body?{top:0,left:0,bottom:window.innerHeight,right:window.innerWidth,height:window.innerHeight,width:window.innerWidth}:t.getBoundingClientRect?t.getBoundingClientRect():void 0}function g(t,e){if(void 0==e)return{width:t.clientWidth,height:t.clientHeight};var i="border-box"===o.css(t,"box-sizing"),n={width:e.width,height:e.height};if(i){var l=d(t);void 0!==n.width&&(n.width=n.width+l.left+l.right),void 0!==n.height&&(n.height=n.height+l.top+l.bottom)}else{var f=w(t);void 0!==n.width&&(n.width=n.width-f.left-f.right),void 0!==n.height&&(n.height=n.height-f.top-f.bottom)}return o.css(t,n),this}function p(t){var e=t.documentElement,i=t.body,o=Math.max,n=o(e.scrollWidth,i.scrollWidth),l=o(e.clientWidth,i.clientWidth),f=o(e.offsetWidth,i.offsetWidth),r=o(e.scrollHeight,i.scrollHeight),h=o(e.clientHeight,i.clientHeight),d=o(e.offsetHeight,i.offsetHeight);return{width:n<f?l:n,height:r<d?h:r}}function a(t){if(i.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:f(e.marginLeft),top:f(e.marginTop),right:f(e.marginRight),bottom:f(e.marginBottom)}}function u(t){var e=x(t),i=a(t);return{width:e.width+i.left+i.right,height:e.height+i.top+i.bottom}}function w(t){if(i.isWindow(t))return{left:0,top:0,right:0,bottom:0};var e=getComputedStyle(t);return{left:f(e.paddingLeft),top:f(e.paddingTop),right:f(e.paddingRight),bottom:f(e.paddingBottom)}}function m(t,e){if(void 0===e){var i=t.getBoundingClientRect(),o=t.ownerDocument.defaultView;return{left:i.left+o.pageXOffset,top:i.top+o.pageYOffset}}var n=r(t),l=m(n),f=a(t),h=d(n);return v(t,{top:e.top-l.top-f.top-h.top,left:e.left-l.left-f.left-h.left}),this}function v(t,i){if(void 0==i){var n=r(t),l=s(t),f=s(n),h=a(t),c=d(n);return{top:l.top-f.top-c.top-h.top,left:l.left-f.left-c.left-h.left}}n=r(t);var g={top:i.top,left:i.left};return e.isDefined(g.top)&&(g.top=g.top+(b(n)||0)),e.isDefined(g.left)&&(g.left=g.left+(y(n)||0)),"static"==o.css(t,"position")&&(g.position="relative"),o.css(t,g),this}function W(t,e){if(void 0===e){var i=r(t),o=c(t),n=s(i),l=(a(t),d(i));return{top:o.top-n.top-l.top,left:o.left-n.left-l.left,width:o.width,height:o.height}}return v(t,e),x(t,e),this}function y(t,e){9===t.nodeType?t=t.defaultView:t==document.body&&(t=document.scrollingElement||document.documentElement);var i="scrollLeft"in t;return void 0===e?i?t.scrollLeft:t.pageXOffset:(i?t.scrollLeft=e:t.scrollTo(e,t.scrollY),this)}function b(t,e){9===t.nodeType?t=t.defaultView:t==document.body&&(t=document.scrollingElement||document.documentElement);var i="scrollTop"in t;return void 0===e?i?t.scrollTop:t.pageYOffset:(i?t.scrollTop=e:t.scrollTo(t.scrollX,e),this)}function x(t,i){if(void 0==i)return e.isWindow(t)?{width:t.innerWidth,height:t.innerHeight}:e.isDocument(t)?p(document):{width:t.offsetWidth,height:t.offsetHeight};var n="border-box"===o.css(t,"box-sizing"),l={width:i.width,height:i.height};if(!n){var f=w(t),r=d(t);void 0!==l.width&&""!==l.width&&null!==l.width&&(l.width=l.width-f.left-f.right-r.left-r.right),void 0!==l.height&&""!==l.height&&null!==l.height&&(l.height=l.height-f.top-f.bottom-r.top-r.bottom)}return o.css(t,l),this}function H(){return H}return e.mixin(H,{borderExtents:d,boundingPosition:s,boundingRect:c,clientHeight:function(t,e){return void 0==e?g(t).height:g(t,{height:e})},clientSize:g,clientWidth:function(t,e){return void 0==e?g(t).width:(g(t,{width:e}),this)},contentRect:function(t){var e=g(t),i=w(t);return{left:i.left,top:i.top,width:e.width-i.left-i.right,height:e.height-i.top-i.bottom}},getDocumentSize:p,hasScrollbar:function(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)},height:function(t,e){return void 0==e?x(t).height:(x(t,{height:e}),this)},marginExtents:a,marginRect:function(t){var e=W(t),i=a(t);return{left:e.left,top:e.top,width:e.width+i.left+i.right,height:e.height+i.top+i.bottom}},marginSize:u,offsetParent:r,paddingExtents:w,pagePosition:m,pageRect:function(t,e){if(void 0===e){var i=t.getBoundingClientRect(),o=t.ownerDocument.defaultView;return{left:i.left+o.pageXOffset,top:i.top+o.pageYOffset,width:Math.round(i.width),height:Math.round(i.height)}}return m(t,e),x(t,e),this},relativePosition:v,relativeRect:W,scrollbarWidth:h,scrollIntoView:function(t,e){var i,o,n,l,f,r,h=t.parentNode,d=function(t,e){var i,o,n=t;for(i=o=0;n&&n!=e&&n.nodeType;)i+=n.offsetLeft||0,o+=n.offsetTop||0,n=n.offsetParent;return{x:i,y:o}}(t,h);return i=d.x,o=d.y,n=t.offsetWidth,l=t.offsetHeight,f=h.clientWidth,r=h.clientHeight,"end"==e?(i-=f-n,o-=r-l):"center"==e&&(i-=f/2-n/2,o-=r/2-l/2),h.scrollLeft=i,h.scrollTop=o,this},scrollLeft:y,scrollTop:b,scrollBy:function(t,e,i){t.scrollLeft+=e,t.scrollTop+=i},size:x,testAxis:function(t){for(var e=t.offsetTop,i=t.offsetLeft,o=t.offsetWidth,n=t.offsetHeight;t.offsetParent;)e+=(t=t.offsetParent).offsetTop,i+=t.offsetLeft;var l={x:0,y:0};return e<window.pageYOffset?l.y=e-window.pageYOffset:e+n>window.pageYOffset+window.innerHeight&&(l.y=e+n-(window.pageYOffset+window.innerHeight)),i<window.pageXOffset?l.x=i-window.pageXOffset:i+o>window.pageXOffset+window.innerWidth&&(l.x=i+o-(window.pageXOffset+window.innerWidth)),l},width:function(t,e){return void 0==e?x(t).width:(x(t,{width:e}),this)}}),function(){var t=Math.max,n=Math.abs,l=/left|center|right/,f=/top|center|bottom/,r=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,s=/%$/;function c(t,e,i){return[parseFloat(t[0])*(s.test(t[0])?e/100:1),parseFloat(t[1])*(s.test(t[1])?i/100:1)]}function g(t,e){return parseInt(o.css(t,e),10)||0}var p={fit:{left:function(e,i){var o,n=i.within,l=n.isWindow?n.scrollLeft:n.offset.left,f=n.width,r=e.left-i.collisionPosition.marginLeft,h=l-r,d=r+i.collisionWidth-f-l;i.collisionWidth>f?h>0&&d<=0?(o=e.left+h+i.collisionWidth-f-l,e.left+=h-o):e.left=d>0&&h<=0?l:h>d?l+f-i.collisionWidth:l:h>0?e.left+=h:d>0?e.left-=d:e.left=t(e.left-r,e.left)},top:function(e,i){var o,n=i.within,l=n.isWindow?n.scrollTop:n.offset.top,f=i.within.height,r=e.top-i.collisionPosition.marginTop,h=l-r,d=r+i.collisionHeight-f-l;i.collisionHeight>f?h>0&&d<=0?(o=e.top+h+i.collisionHeight-f-l,e.top+=h-o):e.top=d>0&&h<=0?l:h>d?l+f-i.collisionHeight:l:h>0?e.top+=h:d>0?e.top-=d:e.top=t(e.top-r,e.top)}},flip:{left:function(t,e){var i,o,l=e.within,f=l.offset.left+l.scrollLeft,r=l.width,h=l.isWindow?l.scrollLeft:l.offset.left,d=t.left-e.collisionPosition.marginLeft,s=d-h,c=d+e.collisionWidth-r-h,g="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,a=-2*e.offset[0];s<0?((i=t.left+g+p+a+e.collisionWidth-r-f)<0||i<n(s))&&(t.left+=g+p+a):c>0&&((o=t.left-e.collisionPosition.marginLeft+g+p+a-h)>0||n(o)<c)&&(t.left+=g+p+a)},top:function(t,e){var i,o,l=e.within,f=l.offset.top+l.scrollTop,r=l.height,h=l.isWindow?l.scrollTop:l.offset.top,d=t.top-e.collisionPosition.marginTop,s=d-h,c=d+e.collisionHeight-r-h,g="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,p="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,a=-2*e.offset[1];s<0?((o=t.top+g+p+a+e.collisionHeight-r-f)<0||o<n(s))&&(t.top+=g+p+a):c>0&&((i=t.top-e.collisionPosition.marginTop+g+p+a-h)>0||n(i)<c)&&(t.top+=g+p+a)}},flipfit:{left:function(){p.flip.left.apply(this,arguments),p.fit.left.apply(this,arguments)},top:function(){p.flip.top.apply(this,arguments),p.fit.top.apply(this,arguments)}}};H.posit=function(s,a){var w,v,W,H,T,L,P,z,O,R,k,D,B,E=(a=e.extend({},a)).of,X=(P=a.within,z=P||window,O=i.isWindow(z),R=!!z&&9===z.nodeType,k=!O&&!R,D=u(z),{element:z,isWindow:O,isDocument:R,offset:k?m(P):{left:0,top:0},scrollLeft:y(z),scrollTop:b(z),width:D.width,height:D.height}),Y=function(t){var e=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-x"),i=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-y"),n="scroll"===e||"auto"===e&&t.width<scrollWidth(t.element);return{width:"scroll"===i||"auto"===i&&t.height<scrollHeight(t.element)?h():0,height:n?h():0}}(X),C=(a.collision||"flip").split(" "),S={};return L=9===(B=E).nodeType?{size:x(B),offset:{top:0,left:0}}:i.isWindow(B)?{size:x(B),offset:{top:b(B),left:y(B)}}:B.preventDefault?{size:{width:0,height:0},offset:{top:B.pageY,left:B.pageX}}:{size:x(B),offset:m(B)},E.preventDefault&&(a.at="left top"),v=L.size.width,W=L.size.height,H=L.offset,T=e.extend({},H),e.each(["my","at"],function(){var t,e,i=(a[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):f.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=f.test(i[1])?i[1]:"center",t=r.exec(i[0]),e=r.exec(i[1]),S[this]=[t?t[0]:0,e?e[0]:0],a[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===C.length&&(C[1]=C[0]),"right"===a.at[0]?T.left+=v:"center"===a.at[0]&&(T.left+=v/2),"bottom"===a.at[1]?T.top+=W:"center"===a.at[1]&&(T.top+=W/2),w=c(S.at,v,W),T.left+=w[0],T.top+=w[1],function(i){var o,l,f=u(i),r=f.width,h=f.height,d=g(i,"marginLeft"),s=g(i,"marginTop"),y=r+d+g(i,"marginRight")+Y.width,b=h+s+g(i,"marginBottom")+Y.height,x=e.extend({},T),L=c(S.my,f.width,f.height);"right"===a.my[0]?x.left-=r:"center"===a.my[0]&&(x.left-=r/2),"bottom"===a.my[1]?x.top-=h:"center"===a.my[1]&&(x.top-=h/2),x.left+=L[0],x.top+=L[1],o={marginLeft:d,marginTop:s},e.each(["left","top"],function(t,e){p[C[t]]&&p[C[t]][e](x,{targetWidth:v,targetHeight:W,elemWidth:r,elemHeight:h,collisionPosition:o,collisionWidth:y,collisionHeight:b,offset:[w[0]+L[0],w[1]+L[1]],my:a.my,at:a.at,within:X,elem:i})}),a.using&&(l=function(e){var o=H.left-x.left,l=o+v-r,f=H.top-x.top,d=f+W-h,s={target:{element:E,left:H.left,top:H.top,width:v,height:W},element:{element:i,left:x.left,top:x.top,width:r,height:h},horizontal:l<0?"left":o>0?"right":"center",vertical:d<0?"top":f>0?"bottom":"middle"};v<r&&n(o+l)<v&&(s.horizontal="center"),W<h&&n(f+d)<W&&(s.vertical="middle"),t(n(o),n(l))>t(n(f),n(d))?s.important="horizontal":s.important="vertical",a.using.call(this,e,s)}),m(i,e.extend(x,{using:l}))}(s)}}(),t.attach("domx.geom",H)});
//# sourceMappingURL=sourcemaps/geom.js.map
